function PartnerController(){Controller.call(this),this.setApiPrefix(),this.setDefault(),this.agentId=this.getQueryString("agentId"),this.bindEvent()}PartnerController.prototype.setApiPrefix=function(){this.sxzApiPrefix="//mk.dev.wkzf:8170/","dev"===this.environment?this.sxzApiPrefix="//mk.dev.wkzf:8170/":"test"===this.environment?this.sxzApiPrefix="//mk.test.wkzf:8170/":"sim"===this.environment?this.sxzApiPrefix="//mk.sim.wkzf/":"prod"===this.environment&&(this.sxzApiPrefix="//mk.wkzf.com/")},PartnerController.prototype.createMask=function(){var t=document.documentElement.scrollHeight,e=document.documentElement.scrollWidth,n=document.createElement("div");n.id="mask-container",$(n).css({"background-color":"rgba(0,0,0,0.7)",position:"fixed",left:0,top:0,height:t+"px",width:e+"px","z-index":"9999",cursor:"pointer"}),$(document.body).append(n)},PartnerController.prototype.setDefault=function(t){var e=this,n=$(".error"),o=$(".br"),i=$(".biz"),r=$(".bizOrd"),a=$(".count");$.ajax({url:e.sxzApiPrefix+"sxzRecommend/getShareSxzInfo.action",type:"GET",dataType:"json"}).done(function(t){if("1"==t.status.toString())o.text(t.data.buySellRatioStr),i.text(t.data.inviteBusinessRatioStr),r.text(t.data.inviteBusinessBillRatioStr),a.text(t.data.num-0+1);else{n.fadeIn("slow",function(){n.text(t.message)}),clearTimeout(e);var e=setTimeout(function(){n.fadeOut("slow")},2e3)}}).fail(function(){n.fadeIn("slow",function(){n.text("获取数据失败")}),clearTimeout(t);var t=setTimeout(function(){n.fadeOut("slow")},2e3)})},PartnerController.prototype.getQueryString=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(e),o="";return null!=n&&(o=n[2]),e=null,n=null,null==o||""==o||"undefined"==o?"":o},PartnerController.prototype.checkPhone=function(t){var e="(^1)[0-9]{10}$",n=new RegExp(e);return n.test(t)},PartnerController.prototype.checkName=function(t){var e=!1;return(!t||t.length>=20)&&(e=!0),e},PartnerController.prototype.bindEvent=function(){var t=this,e=$(".error"),n=$(".confirm");$(".submit").on("click",function(o){o.preventDefault();var i=$.trim($("#phoneNum").val()),r=$.trim($("#name").val());if(t.checkPhone(i))if(t.checkName(r)){e.fadeIn("slow",function(){e.text("姓名输入有误")}),clearTimeout(a);var a=setTimeout(function(){e.fadeOut("slow",function(){e.text("")})},2e3)}else{var s={agentId:t.agentId,phoneNum:i,name:r,source:2};$.ajax({url:t.sxzApiPrefix+"sxzRecommend/enroll.action",method:"get",dataType:"json",data:s}).done(function(o){if("1"==o.status.toString())t.createMask(),n.fadeIn("slow");else{e.fadeIn("slow",function(){e.text(o.message)}),clearTimeout(i);var i=setTimeout(function(){e.fadeOut("slow")},2e3)}}).fail(function(){e.fadeIn("slow",function(){e.text("提交失败")}),clearTimeout(t);var t=setTimeout(function(){e.fadeOut("slow",function(){e.text("")})},2e3)})}else{e.fadeIn("slow",function(){e.text("手机号输入有误")}),clearTimeout(a);var a=setTimeout(function(){e.fadeOut("slow",function(){e.text("")})},2e3)}}),$("body").delegate("#mask-container","click",function(t){$(".confirm").hide(),$("#mask-container").remove()}),$(".ok").on("click",function(t){t.preventDefault(),$(".confirm").hide(),$("#mask-container").remove()}),window.addEventListener("resize",function(t){var e=$(".submit");e[0].scrollIntoView(!1)})},$(document).ready(function(){new PartnerController});