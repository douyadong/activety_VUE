function DSXController(){Controller.call(this),this.setApiPrefix(),this.agentId=this.getQueryString("agentId"),this.bindEvent()}DSXController.prototype.setApiPrefix=function(){this.sxzApiPrefix="//mk.dev.wkzf:8170/","dev"===this.environment?this.sxzApiPrefix="//mk.dev.wkzf:8170/":"test"===this.environment?this.sxzApiPrefix="//mk.test.wkzf:8170/":"sim"===this.environment?this.sxzApiPrefix="//mk.sim.wkzf/":"prod"===this.environment&&(this.sxzApiPrefix="//mk.wkzf.com/")},DSXController.prototype.createMask=function(){var e=document.documentElement.scrollHeight,t=document.documentElement.scrollWidth,n=document.createElement("div");n.id="mask-container",$(n).css({"background-color":"rgba(0,0,0,0.7)",position:"fixed",left:0,top:0,height:e+"px",width:t+"px","z-index":"9999",cursor:"pointer"}),$(document.body).append(n)},DSXController.prototype.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t),o="";return null!=n&&(o=n[2]),t=null,n=null,null==o||""==o||"undefined"==o?"":o},DSXController.prototype.checkPhone=function(e){var t="(^1)[0-9]{10}$",n=new RegExp(t);return n.test(e)},DSXController.prototype.bindEvent=function(){var e=this,t=$(".error"),n=$(".qrcode");$(".submit").on("click",function(o){o.preventDefault();var i=$("#phoneNum").val();if(e.checkPhone(i)){var r={agentId:e.agentId,phoneNum:i,source:1};$.ajax({url:e.sxzApiPrefix+"sxzRecommend/enroll.action",method:"get",dataType:"json",data:r}).done(function(o){if("1"==o.status.toString()){e.createMask(),n.fadeIn("slow"),clearTimeout(i);var i=setTimeout(function(){t.fadeOut("slow")},2e3)}else{t.fadeIn("slow",function(){t.text(o.message)}),clearTimeout(i);var i=setTimeout(function(){t.fadeOut("slow",function(){t.text("")})},2e3)}}).fail(function(){t.fadeIn("slow",function(){t.text("提交失败")}),clearTimeout(e);var e=setTimeout(function(){t.fadeOut("slow",function(){t.text("")})},2e3)})}else{t.fadeIn("slow",function(){t.text("手机号输入有误")}),clearTimeout(s);var s=setTimeout(function(){t.fadeOut("slow",function(){t.text("")})},2e3)}}),$("body").delegate("#mask-container","click",function(e){$(".qrcode").hide(),$("#mask-container").remove()}),window.addEventListener("resize",function(e){var t=$(".submit");t[0].scrollIntoView(!1)})},$(document).ready(function(){new DSXController});