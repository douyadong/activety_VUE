/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1. 项目名称：斗鱼直播－web
 2. 页面名称：douyu/web(斗鱼直播web)
 3. 作者：luwei@lifang.com
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
function WebController() {
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
     继承于Controller基类
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    Controller.call(this);
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
     bindEvent
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.bindEvent();
};
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 绑定事件
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
WebController.prototype.bindEvent = function() {
    var classSelf = this;
    $('.play_btn').on('click', function(event) {
        event.preventDefault();
        /* Act on the event */
        var activityId = $('#activity_id').val();
        var data = {
            id: activityId
        };
        classSelf.request(classSelf.apiUrl.douyu.getStatus, data, {
            'type': 'post',
            'apiDataType': 'jsonp',
            'showLoadingTips': false,
            'process': function(data) {
                var state = data.data.state.toString();
                if (state === '1') {
                    classSelf.showLog("悟空直播将于6月30日下午两点开始，敬请期待哟～！");
                } else if (state === '2') {
                    window.location.href = 'http://m.douyu.com/676965';
                } else if (state === '3') {
                    classSelf.showLog("本期直播已结束，小悟空正在上传视频，敬请期待哦~");
                }
            },
            'onExceptionInterface': function(data) {
                //显示出错信息
                classSelf.showLog(data.message);
            }
        });
    });
};
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
类的初始化
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
$(document).ready(function() {
    new WebController;
});
