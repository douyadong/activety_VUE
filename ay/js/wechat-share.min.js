function WechatShareController(e){this.opts=e||{},"canShareTimeline"in e?this.opts.canShareTimeline=e.canShareTimeline:this.opts.canShareTimeline=!0,"canShareAppMessage"in e?this.opts.canShareAppMessage=e.canShareAppMessage:this.opts.canShareAppMessage=!0,this.opts.title=e.title||$("#wechatTitle").val(),this.opts.content=e.content||$("#wechatContent").val(),this.opts.linkUrl=e.linkUrl||window.location.href,this.opts.imgUrl=e.imgUrl||"http:"+$("#wechatImgUrl").val(),this.environment=STAGE_ENVIRONENT,this.apiPrefix="//10.0.18.78:8134/",this.apiUrl="","test"===this.environment?this.apiPrefix="//10.0.18.79:8134/":"beta"===this.environment?this.apiPrefix="//wechat-beta.wkzf.com/":"sim"===this.environment?this.apiPrefix="//wechat-beta.wkzf.com/":"prod"===this.environment&&(this.apiPrefix="//wechat.wkzf.com/"),this.apiUrl=this.apiPrefix+"wx_js_sdk_sign.rest",this.wx_onMenuShareTimeline=function(e,t,n){wx.onMenuShareTimeline({title:e,link:t,imgUrl:n,trigger:function(e){},success:function(e){console.log("wx_onMenuShareTimeline success "+t)},cancel:function(e){},fail:function(e){}})},this.wx_onMenuShareAppMessage=function(e,t,n,i){wx.onMenuShareAppMessage({title:e,desc:n,link:t,imgUrl:i,type:"",dataUrl:"",success:function(){console.log("wx_onMenuShareAppMessage success "+t)},cancel:function(){}})},this.sendRequest=function(){var e=this;$.ajax({url:this.apiUrl,type:"GET",data:{requestUrl:window.location.href},dataType:"jsonp",jsonpCallback:"callback",error:function(e){},success:function(t){var n=t.data;wx.config({debug:!1,appId:n.appid,timestamp:n.timestamp,nonceStr:n.nonce_str,signature:n.signature,jsApiList:["onMenuShareAppMessage","onMenuShareTimeline","chooseImage","uploadImage","previewImage","hideMenuItems"]}),e.opts.wxConfigCallback&&e.opts.wxConfigCallback(t)}})},this.onload=function(){var e=this;wx.ready(function(){wx.showOptionMenu(),e.opts.canShareTimeline?e.wx_onMenuShareTimeline(e.opts.title,e.opts.linkUrl,e.opts.imgUrl):wx.hideMenuItems({menuList:["menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp"]}),e.opts.canShareAppMessage?e.wx_onMenuShareAppMessage(e.opts.title,e.opts.linkUrl,e.opts.content,e.opts.imgUrl):wx.hideMenuItems({menuList:["menuItem:share:appMessage"]})}),e.sendRequest()},this.onload()}