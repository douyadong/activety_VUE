!function(e){e.fn.pullload=function(a){var l=e.extend({},e.fn.pullload.defaults,a);return this.each(function(){var a=this;e(this).attr("requestable","true"),e(l.handler).on("scroll.pullload",function(){var t=e(window).height(),s=e(window).scrollTop(),n=e(a).children().last(),o=e(a).children().last().prev(),i=n.height()+n.offset().top+l.threshold,r=o.height()+o.offset().top+l.threshold,d=i>r?i:r;t+s>d&&"true"==e(a).attr("requestable")&&e.fn.pullload.request(a,l)})})},e.fn.pullload.request=function(a,l){e(a).attr("requestable","false");var t=l.crossDomain?"jsonp":"json",s=l.crossDomain?"GET":l.requestType,n={};n[l.requestLoadedKey]=e(a).children().size()-1,n[l.pageSizeKey]=e(a).attr(l.pageSizeKey);try{e.ajax({url:l.apiUrl,type:s,dataType:t,data:n,success:function(t){l.callback&&l.callback(t),e(a).attr("requestable","true")},error:function(t){e.fn.pullload.tips(l.loadFailedTips,a,l)}})}catch(o){e.fn.pullload.tips("错误名称："+o.name+"\n错误描述："+o.message)}},e.fn.pullload.tips=function(a,l,t){0===e(l).next("."+t.tipsClassName).size()&&e(l).after('<div class="'+t.tipsClassName+'"></div>');var s=e(l).next("."+t.tipsClassName);s.html(a),s.slideDown(100)},e.fn.pullload.closeTips=function(a,l){e(a).next("."+l.tipsClassName).slideUp(100)},e.fn.pullload.defaults={handler:window,apiUrl:"",crossDomain:!1,requestType:"GET",callback:null,requestLoadedKey:"loaded",pageIndexKey:"pageIndex",pageSizeKey:"pageSize",countKey:"count",tipsClassName:"data-status",loadingTips:"数据加载中...",lastLoadedTips:"已经加载到最后一页！",loadFailedTips:"数据加载失败，请重试！",threshold:50}}(jQuery);